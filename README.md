# SuperPitchMonitor

A real-time polyphonic pitch detection and visualization application based on the JUCE framework. Supports multi-resolution spectral analysis for accurate pitch detection across the full frequency range.

## Features

- **Real-time Pitch Detection**: Monophonic and polyphonic pitch detection
- **Multi-resolution Analysis**: Adaptive FFT resolution for different frequency bands
- **Cross-platform**: Windows, macOS, Linux, Android, iOS
- **Visual Feedback**: Spectrum display, pitch waterfall, and pitch cards
- **Test Framework**: Python-based automated testing with FFT reference analysis

## Quick Start

### One-Click Setup

Choose your platform:

#### Windows
```powershell
# Run setup script (generates test audio + builds project)
scripts\build\setup_windows.bat
```

#### macOS
```bash
# Run setup script
chmod +x scripts/build/setup_macos.sh
scripts/build/setup_macos.sh

# Then build
cd build-macos
cmake --build . --config Release
```

#### Linux
```bash
# Run setup script
chmod +x scripts/build/setup_linux.sh
scripts/build/setup_linux.sh

# Then build
cd build-linux
cmake --build . --config Release -j$(nproc)
```

## Manual Build Guide

### Prerequisites

- CMake 3.15+
- C++17 compatible compiler
- Python 3.7+ (for generating test audio)
- Git

**Note:** 
- JUCE framework will be downloaded automatically by CMake during the first build
- Downloaded dependencies are cached in `ThirdParty/` directory (not committed to git)
- Once cached, you can build offline without internet connection

### Step 1: Clone Repository

```bash
git clone https://github.com/yourusername/SuperPitchMonitor.git
cd SuperPitchMonitor
```

### Step 2: Generate Test Audio Files

Test audio files are generated by Python scripts and **not** included in the repository.

```bash
# Install Python dependencies
pip install numpy scipy

# Generate all test audio (10-second files for 0.1Hz FFT resolution)
python scripts/audio/generate_all_tests.py
```

This will create audio files in `Resources/TestAudio/`.

### Step 3: Build

**Note:** First build will download JUCE automatically (requires internet connection).

#### Windows (Visual Studio)

```bash
mkdir build-windows && cd build-windows
cmake .. -G "Visual Studio 17 2022" -A x64
# First build: JUCE will be downloaded automatically
cmake --build . --config Release
```

#### macOS (Xcode)

```bash
mkdir build-macos && cd build-macos
cmake .. -G Xcode -DCMAKE_BUILD_TYPE=Release
# First build: JUCE will be downloaded automatically
cmake --build . --config Release
```

#### Linux (Makefile)

```bash
mkdir build-linux && cd build-linux
cmake .. -DCMAKE_BUILD_TYPE=Release
# First build: JUCE will be downloaded automatically
cmake --build . -j$(nproc)
```

#### Android

See [Android Build Guide](Docs/07_Build/BuildGuide.md)

## Project Structure

```
SuperPitchMonitor/
├── CMakeLists.txt              # Main CMake configuration
├── LICENSE                     # GPLv3 License
├── README.md                   # This file
│
├── Source/                     # Source code
│   ├── Audio/                 # Audio processing (pitch detection, spectrum)
│   ├── UI/                    # User interface components
│   ├── Test/                  # Automated testing framework
│   └── Utils/                 # Utilities (logger, config)
│
├── Resources/                  # Resources
│   └── TestAudio/             # Test audio files (generated, not in git)
│
├── scripts/                    # Scripts organized by category
│   ├── audio/                 # Audio generation scripts
│   ├── build/                 # Build setup scripts
│   ├── test/                  # Test and analysis scripts
│   └── utils/                 # Utility scripts
│
├── Docs/                       # Documentation
│   ├── 01_TechnicalAnalysis/  # Technical analysis
│   ├── 02_Architecture/       # Architecture docs
│   ├── 07_Build/              # Build guides
│   └── test_reports/          # Test reports
│
├── ThirdParty/                 # External dependencies cache (downloaded by CMake)
│   ├── juce-src/              # JUCE framework (auto-downloaded)
│   └── ...                    # Future dependencies
│
├── Saved/                      # Runtime generated data (not in git)
│   └── Logs/                  # Application runtime logs
│
└── build-*/                    # Build directories (platform-specific, generated)
    └── logs/                  # Build logs (for debugging build failures)
```

## Testing

### Automated Testing

The project includes a comprehensive Python test framework:

```bash
# Generate test audio (if not already done)
python scripts/audio/generate_all_tests.py

# Run detailed analysis with FFT comparison
python scripts/test/test_detailed_analysis.py --file chord_c_major_7_piano.wav

# Run all tests
python scripts/test/test_detailed_analysis.py --all
```

Test reports are saved to `Docs/test_reports/`.

### Test Framework Features

- **High-precision FFT**: 10-second window, 0.1Hz resolution
- **Per-frame SPM analysis**: Frequency, confidence, amplitude statistics
- **Multi-resolution comparison**: Tests both MR-ON and MR-OFF modes
- **Detailed HTML reports**: Per-file comparison tables

## Key Algorithms

- **Multi-resolution FFT**: Different FFT sizes for low/mid/high frequencies
- **YIN Pitch Detection**: Time-domain periodicity analysis
- **Harmonic Analysis**: Separates fundamentals from harmonics
- **Polyphonic Separation**: Identifies multiple simultaneous pitches

## Documentation

See the `Docs/` directory for:
- [Technical Analysis](Docs/01_TechnicalAnalysis/) - Algorithm details
- [Architecture](Docs/02_Architecture/) - System design
- [Build Guides](Docs/07_Build/) - Platform-specific instructions

## License

This project is licensed under the **GNU General Public License v3.0 (GPLv3)**.

This software uses the [JUCE](https://juce.com/) framework, which is also licensed under GPLv3 (with commercial licensing alternatives available).

See [LICENSE](LICENSE) file for details.

### Commercial Licensing

If you need to use this software in a closed-source commercial product, you must:
1. Purchase a JUCE commercial license from Raw Material Software
2. Contact the author for a commercial license to this software

## Development Notes

### Cross-platform Considerations

- **Line endings**: Repository uses LF (Unix-style). Configure Git:
  ```bash
  git config core.autocrlf true  # Windows
  git config core.autocrlf input # macOS/Linux
  ```

- **Build directories**: Use platform-specific prefixes:
  - `build-windows/` - Windows builds
  - `build-macos/` - macOS builds
  - `build-linux/` - Linux builds

- **Test audio**: Always run `scripts/audio/generate_all_tests.py` after cloning to generate test files

### Git Workflow

```bash
# After cloning
git clone https://github.com/username/SuperPitchMonitor.git
cd SuperPitchMonitor

# Generate test audio
python scripts/audio/generate_all_tests.py

# Make changes...

# Commit and push
git add .
git commit -m "Description of changes"
git push origin main
```

## Directory Structure

### Generated Directories (not in Git)

| Directory | Purpose | Persistence |
|-----------|---------|-------------|
| `ThirdParty/` | External dependencies (JUCE, etc.) | ✅ Persistent |
| `Saved/Logs/` | Application runtime logs | ✅ Persistent |
| `build-*/` | Build outputs and build logs | ❌ Can be deleted |
| `Resources/TestAudio/` | Generated test audio files | ✅ Persistent |

### Logs Location

- **Runtime Logs**: `Saved/Logs/*.log` - Application execution logs
- **Build Logs**: `build-*/logs/*.log` - CMake and compilation logs (useful for debugging build failures)

## Troubleshooting

### CMake not found
- **Windows**: Install from https://cmake.org/download/
- **macOS**: `brew install cmake`
- **Linux**: `sudo apt-get install cmake`

### Python dependencies missing
```bash
pip install numpy scipy
```

### Test audio not found
```bash
# Regenerate test audio
python scripts/audio/generate_all_tests.py
```

## Contact

[Your Contact Information]
